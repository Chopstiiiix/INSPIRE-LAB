# =============================================================================
# Coturn TURN Server Configuration
# =============================================================================
# Documentation: https://github.com/coturn/coturn/wiki/turnserver
#
# This configuration uses time-limited credentials via shared secret.
# LiveKit and your app generate credentials using HMAC-SHA1.
# =============================================================================

# -----------------------------------------------------------------------------
# Network Configuration
# -----------------------------------------------------------------------------

# Listening ports
listening-port=3478
tls-listening-port=5349

# Alternative ports (some networks block 3478)
alt-listening-port=3479
alt-tls-listening-port=5350

# Relay port range
min-port=49152
max-port=49252

# External IP (REQUIRED for NAT traversal)
# Uncomment and set to your server's public IP
# external-ip=YOUR_PUBLIC_IP/YOUR_PRIVATE_IP
# Example: external-ip=203.0.113.1/10.0.0.1

# -----------------------------------------------------------------------------
# Authentication
# -----------------------------------------------------------------------------

# Use long-term credentials with time-limited tokens
lt-cred-mech

# Static auth secret (shared with LiveKit)
# Generate with: openssl rand -hex 32
# This MUST match TURN_SECRET in your .env
use-auth-secret
static-auth-secret=your_turn_secret_here

# Realm (use your domain)
realm=localhost

# -----------------------------------------------------------------------------
# Security
# -----------------------------------------------------------------------------

# Enable fingerprints in TURN messages
fingerprint

# Disable older TLS versions
no-tlsv1
no-tlsv1_1

# Don't allow peers to connect to localhost
no-loopback-peers

# Don't allow peers to connect to private ranges
# (Uncomment for production security)
# denied-peer-ip=10.0.0.0-10.255.255.255
# denied-peer-ip=172.16.0.0-172.31.255.255
# denied-peer-ip=192.168.0.0-192.168.255.255
# denied-peer-ip=127.0.0.0-127.255.255.255

# Allow localhost for development
allowed-peer-ip=127.0.0.1

# -----------------------------------------------------------------------------
# Performance
# -----------------------------------------------------------------------------

# Total allocation quota
total-quota=100

# Max bandwidth per session (0 = unlimited)
bps-capacity=0

# Stale nonce lifetime
stale-nonce=600

# User quota
user-quota=12
max-bps=0

# -----------------------------------------------------------------------------
# Logging
# -----------------------------------------------------------------------------

# Log to stdout (for Docker)
log-file=stdout
verbose

# Uncomment for more detailed logging
# Verbose

# -----------------------------------------------------------------------------
# TLS/SSL (for production)
# -----------------------------------------------------------------------------

# Uncomment and configure for TLS
# cert=/etc/coturn/cert.pem
# pkey=/etc/coturn/key.pem
# cipher-list="ECDHE-RSA-AES256-GCM-SHA512:DHE-RSA-AES256-GCM-SHA512"

# -----------------------------------------------------------------------------
# Server Identity
# -----------------------------------------------------------------------------

server-name=inspire-lab-turn

# Don't run CLI (not needed in Docker)
no-cli

# Mobile client support
mobility

# Process user/group
# proc-user=turnserver
# proc-group=turnserver

# -----------------------------------------------------------------------------
# STUN-only mode (uncomment to disable TURN relay)
# -----------------------------------------------------------------------------
# stun-only
